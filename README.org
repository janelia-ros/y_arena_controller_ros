#+TITLE: y_arena_controller_ros
#+AUTHOR: Peter Polidoro
#+EMAIL: peterpolidoro@gmail.com

* Repository Information
  - Author :: Peter Polidoro
  - License :: BSD

  Valve controller software for the Turner Lab Y-Arena rig.

* Run Docker Container

  Make sure all arenas are connected by USB to Raspberry Pi before powering it
  up.

  Container starts automatically shortly after booting the Raspberry Pi.

  If you want to start the container manually after stopping it:

  #+BEGIN_SRC sh
    find_devices_then_run
  #+END_SRC

* Find Running Container Name

  #+BEGIN_SRC sh
    docker ps
  #+END_SRC

* Run Bash Commands in Container

  #+BEGIN_SRC sh
    docker exec -it <container name> /bin/bash
    source install/setup.bash
    ros2 node list
  #+END_SRC

* Stop Docker Container

  #+BEGIN_SRC sh
    docker stop $(docker ps -aq)
  #+END_SRC

* Run Another Docker Container to Publish Test Messages

  #+BEGIN_SRC sh
    docker run --rm --net=host --pid=host -it y_arena_valve_controller:latest
    ros2 topic pub --once /arena_valves_open y_arena_interfaces/msg/ArenaValves "{arena: 0, valves: [0, 1, 2]}"
  #+END_SRC

